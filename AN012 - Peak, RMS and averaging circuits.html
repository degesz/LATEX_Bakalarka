<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0039)https://sound-au.com/appnotes/an012.htm -->
<html lang="en" data-darkreader-mode="dynamic" data-darkreader-scheme="dark" data-darkreader-proxy-injected="true" class=" xozzonxf idc0_350"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: var(--darkreader-background-ffffff, #181a1b) !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: dark !important;
}
html, body {
    background-color: var(--darkreader-background-ffffff, #181a1b);
}
html, body {
    border-color: var(--darkreader-border-4c4c4c, #736b5e);
    color: var(--darkreader-text-000000, #e8e6e3);
}
a {
    color: var(--darkreader-text-0040ff, #3391ff);
}
table {
    border-color: var(--darkreader-border-808080, #545b5e);
}
mark {
    color: var(--darkreader-text-000000, #e8e6e3);
}
::placeholder {
    color: var(--darkreader-text-a9a9a9, #b2aba1);
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: var(--darkreader-background-faffbd, #404400) !important;
    color: var(--darkreader-text-000000, #e8e6e3) !important;
}
::selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
::-moz-selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
}</style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]>svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: var(--darkreader-background-ffffff, #181a1b);
   --darkreader-neutral-text: var(--darkreader-text-000000, #e8e6e3);
   --darkreader-selection-background: var(--darkreader-background-0060d4, #004daa);
   --darkreader-selection-text: var(--darkreader-text-ffffff, #e8e6e3);
}</style><style class="darkreader darkreader--root-vars" media="screen"></style>
	<link rel="canonical" href="https://sound-au.com/appnotes/an012.htm">
	
	<meta name="Author" content="Rod Elliott - Elliott Sound Products">
	<meta name="keywords" content="average, rms, diy, circuit, schematic, diagram">
	<meta name="description" content="ESP Application Notes - AN012 - Peak, RMS and averaging circuits">
	<!-- ESP  Application Notes - AN012 - Peak, RMS and averaging circuits -->
	<title>AN012 - Peak, RMS and averaging circuits</title>
	<link rel="StyleSheet" href="./AN012 - Peak, RMS and averaging circuits_files/esp.css" type="text/css" media="screen, print"><style class="darkreader darkreader--sync" media="screen"></style>
	<style type="text/css"><!-- td { font-size: 11pt } th { font-size: 11pt } --> </style><style class="darkreader darkreader--sync" media="screen"></style>
	<link rel="shortcut icon" type="image/ico" href="https://sound-au.com/appnotes/favicon.ico">
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-1947877433449191",
          enable_page_level_ads: true
     });
</script><meta name="darkreader" content="c7040afd4f254755a03653fd77aca223"><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select {
    --darkreader-bg--form-control-background-color: rgba(22, 22, 22, 0) !important;
}
select * {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content > div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter > ul > li > a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}</style>
</head>
<body>
<table style="width: 100%"><tbody><tr><td><img src="./AN012 - Peak, RMS and averaging circuits_files/esp.jpg" alt="ESP Logo" height="81" width="215">
</td><td align="right">

<script async="" src="./AN012 - Peak, RMS and averaging circuits_files/f.txt"></script>
	<!-- 468x60, created 20/08/10 -->
	<ins class="adsbygoogle" style="display:inline-block;width:468px;height:60px" data-ad-client="ca-pub-1947877433449191" data-ad-slot="7119701939" data-adsbygoogle-status="done"><iframe id="aswift_0" style="height: 1px !important; max-height: 1px !important; max-width: 1px !important; width: 1px !important;" src="./AN012 - Peak, RMS and averaging circuits_files/saved_resource.html"><iframe id="google_ads_frame0" src="./AN012 - Peak, RMS and averaging circuits_files/saved_resource(1).html"></iframe></iframe></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</td></tr></tbody></table>

<table style="width: 100%" class="tblblue"><tbody><tr><td class="hdrl">&nbsp;Elliott Sound Products</td>
<td align="right" class="hdrr">AN-012&nbsp;</td></tr></tbody></table>

<center><h1>Peak, RMS And Averaging Circuits</h1>
<small>Rod Elliott (ESP)</small></center>

<!-- AddThis Button BEGIN -->
	<div class="addthis_inline_share_toolbox"></div>
<!-- AddThis Button END -->

<hr><span class="imgswap"><a href="https://sound-au.com/index.html" style="display:block;"><img src="./AN012 - Peak, RMS and averaging circuits_files/a1.gif" alt="Home"><b class="bb">Main Index</b></a></span>
<span class="imgswap"><a href="https://sound-au.com/appnotes/index.html" style="display:block;"><img src="./AN012 - Peak, RMS and averaging circuits_files/a1.gif" alt="app notes"><b class="bb">App. Notes Index</b></a></span><hr>

<b>AC Voltage Measurement</b>
<p>There are countless reasons to measure an AC voltage, and the type of measurement used can be critical in many cases.&nbsp; With few exceptions, the AC component of the waveform will have any DC removed by means of a capacitor, and the voltage is then rectified.&nbsp; For most measurement systems, this will be done using one of the full wave precision rectifier circuits described in <a href="https://sound-au.com/appnotes/an001.htm" target="_blank">AN-001</a>.&nbsp; This part of the process is critical, and the type of circuit used is determined by the required accuracy, signal frequency and the level.</p>

<p>Even the very best precision rectifier will give poor results if the signal level is too low, so a preamp is often needed.&nbsp; High frequencies (above 1MHz) create additional problems, and these will not be covered here.&nbsp; I will concentrate on systems that work at normal audio frequencies, which includes mains frequencies (50 and 60Hz).&nbsp; The range covered can often be very limited - especially when a system is designed specifically for mains and other frequencies below around 1kHz or so.</p>

<p>When the signal is to be digitised, there are two options.&nbsp; The signal can be and fed directly to an ADC (analogue to digital converter) without rectification, and all calculations are done digitally.&nbsp; The incoming signal has to be level-shifted (typically so that zero is represented by 2.50V DC), and the digital sampling frequency has to be an absolute minimum of double the highest frequency of interest.&nbsp; For example, frequencies up to 20kHz require a minimum sampling frequency of 40kHz, and as we know, a common standard is 44.1kHz as used for CD quality audio.</p>

<p>The second option is to remain within the analogue domain, and the signal can be displayed by a moving coil meter movement, or digitised using a low frequency ADC as used in most multimeters.&nbsp; In some cases, the rectified AC is not used to drive any form of metering, but may be used to provide automatic gain control (AGC), compression, limiting or other functions in an audio processing system.</p>

<p>The circuits described below assume the second option.&nbsp; The incoming AC will have any DC component removed with a coupling capacitor, and will be rectified with a precision rectifier.&nbsp; The pulsating DC output from the rectifier is then processed to obtain the desired type of measurement - peak, RMS or average.&nbsp; The output can vary widely depending on which method is used, and some of the results can be surprising.</p>

<p class="t-pic"><img src="./AN012 - Peak, RMS and averaging circuits_files/an012-f1.gif" alt="Figure 1" border="1"><br>Figure 1 - Precision Full-Wave Rectifier</p>

<p>For the sake of consistency, I will assume the rectifier shown above.&nbsp; This is taken from <a href="https://sound-au.com/appnotes/an001.htm" target="_blank">AN-001</a> Figure 6, and was chosen because it's a simple circuit that works well.&nbsp; Any of the other circuits can be used, but for peak detection, they all require a half wave rectifier after the main rectifier because the cap has to be charged via a circuit that doesn't discharge it again.</p>

<p>In some cases you can get away with highly simplified circuits, but it all depends on the application and the degree of accuracy you expect.&nbsp; In a few cases (such as audio processing), accuracy is not needed, and non-linear behaviour can be an advantage rather than a limitation.</p>

<p>It's important to understand that all methods of measurement can introduce errors, and that there is no one detection technique that's suitable for all waveforms.&nbsp; Errors and limitations are discussed in further detail in the conclusions at the end of this article.</p>  


<hr><b>Peak Reading</b>
<p>Obtaining the peak value of the waveform is pretty easy if extreme precision isn't needed, and is one of the most common - especially for audio processing circuits.&nbsp; For example, an audio peak limiter should, by definition, apply limiting based on the peak value of the waveform.&nbsp; Most compressor/ limiters work on this basis, but some may also use the average value, and a small number use RMS converters to derive the control voltage.</p>

<p>This article is not about audio compressors or limiters though, so if you want more on that topic you'll have to look through the various ESP projects (see the <a href="https://sound-au.com/p-list.htm" target="_blank">ESP Project List</a> and search for 'limiter').&nbsp; There are many other circuits on the Net of course, and you will see a great many variations.</p>

<p>In many cases, when an AC voltage is rectified, the peak voltage may be used because it's the fastest measurement method.&nbsp; If the input signal is a sinewave, the meter can be calibrated for RMS if desired.&nbsp; Under these conditions, the meter is simply calibrated so that when the input is 1V DC, the meter is set to display exactly 707mV.&nbsp; This is based on the square root of 2 (√2) which is 1.414 (and 0.707 - its reciprocal).&nbsp; Most readers will be aware that the peak value of a 1V sinewave is 1.414V, but may not be aware of the limitations of this measurement method.</p>

<p>All that's needed in some cases is a capacitor, but that depends on the precision rectifier circuit used.&nbsp; The majority of full-wave rectifiers need an output diode (ok if precision isn't necessary) or a precision half wave rectifier as shown below.&nbsp; The added diode/ half wave rectifier is needed so the cap is not discharged back through the rectifier's output opamp.&nbsp; A highly simplified version is shown in Figure 2, and this could be used for a peak limiter circuit for example.&nbsp; It's not useful for accurate measurements though.&nbsp; If R4 is not included, some means to discharge C1 is necessary, otherwise it will retain the voltage indefinitely, but subject to drift due to diode and capacitor leakage.</p>
 
<p class="t-pic"><img src="./AN012 - Peak, RMS and averaging circuits_files/an012-f2.gif" alt="Figure 2" border="1"><br>Figure 2 - Simplified Peak Reading Detector</p>

<p>The most basic half-wave peak detector uses nothing more than a diode, a pair of resistors and a capacitor.&nbsp; A full-wave version of this is shown above, but because the diodes are not within a feedback loop it suffers from high non-linearity because of the forward voltage of the diodes.&nbsp; This arrangement is suitable if you don't need absolute accuracy, or if the range of voltages to be measured is limited.&nbsp; For example, if you only need to detect a voltage of between 5V and 10V (peak), the error introduced by the diode is minimal and easily compensated, but for a precision circuit that's not good enough.&nbsp; The circuit is full wave because there is a direct and inverted driver for the diodes.</p>

<p>The two resistors (R4 &amp; R5) determine how quickly the capacitor charges (R5) and discharges (R4).&nbsp; They are wired as shown so they don't create a voltage divider as would be the case if R4 was directly in parallel with the storage/ smoothing cap (C1).&nbsp; The charge (attack) time is determined by the ratio of the values of R5 and C1.&nbsp; If R5 is 1k and C1 is 1µF, the charge time (with DC, and to 63.2% of maximum, aka time constant) is 1ms, and the full voltage (within 1%) will be available in around 5ms.&nbsp; The decay time is determined by the ratio of C1, and R4 plus R5 in series.&nbsp; It's close enough to 1 second with the values shown.&nbsp; With an AC input it depends on the frequency.</p>

<p class="t-pic"><img src="./AN012 - Peak, RMS and averaging circuits_files/an012-f3.gif" alt="Figure 3" border="1"><br>Figure 3 - Precision Peak Reading Detector</p>

<p>When a true precision peak detector is used, the cap will always charge almost instantaneously, because it's within the feedback loop of an opamp.&nbsp; This isn't always convenient, especially for audio processing where the attack and decay times need to be programmable.&nbsp; For measurements, it provides the fastest possible reading, with a stable voltage available within as little as a single cycle, but more typically within couple of cycles of the input waveform.</p>

<p>For a variety of reasons (based on simple reality and physics), the voltage across C1 may be a little lower than expected.&nbsp; It will typically be around 0.4% low with a 100mV input, but the error increases as the level is reduced, and vice versa.&nbsp; If there is any overshoot of the input signal, the voltage across C1 will be <i>higher</i> than expected.&nbsp; Careful layout is essential if you want an accurate circuit.</p>

<p>Peak reading is not common in metering circuits other than Peak Programme Meters (PPMs), where their use is essential (by definition).&nbsp; Peak detection - usually non-precision - is far more common with audio processing systems.&nbsp; If you use peak detection as described here for conventional metering (RMS calibrated), the 'RMS' reading is only accurate when the input is a sinewave.&nbsp; Serious errors will be apparent for other waveforms.</p>

<p>When you need to monitor the amplitude of the highest peaks of a signal (usually audio, but not always), you also need to decide on the decay time.&nbsp; If it's too short, you won't have time to see the peaks (and an analogue movement's pointer can't move fast enough).&nbsp; If the decay time is too long, you won't be able to see other (smaller) peaks until the pointer has fallen to the level of the new peaks.&nbsp; The ballistics of professional PPMs depend upon the standard(s) used - there are several different versions.</p>

 
<hr><b>Average Reading</b>
<p>With most measurement systems, it's more common to use the average reading than the peak.&nbsp; This happens 'automatically' if a moving coil meter movement is used following a precision rectifier, because the pointer deflection depends on the average current.&nbsp; As with a peak measurement, the RMS value for a sinewave is obtained simply by scaling the rectified voltage, and in this case a meter would be adjusted to read 707mV with an input of 637mV.&nbsp; The average value of a sinewave is determined by&nbsp;...</p>

<blockquote>
	2 × V<sub>(peak)</sub> / π = 0.6366 (0.637) for a 1V peak sinewave (707mV RMS)
</blockquote>

<p>It is important to understand that the average value of a sinewave (as described above) can only be used after rectification.&nbsp; If the signal isn't rectified, the average is zero! This is because the positive and negative voltages are exactly equal, so they cancel.&nbsp; For speech or music signals, there can be a wide variance between the RMS and average values after rectification, but most analogue meters use averaging because true RMS measurement was difficult to achieve until comparatively recently.</p>

<p class="t-pic"><img src="./AN012 - Peak, RMS and averaging circuits_files/an012-f4.gif" alt="Figure 4" border="1"><br>Figure 4 - Precision Average Reading Detector</p>

<p>Although Figure 4 shows both input and output buffers, they may not be needed depending on the application.&nbsp; The time constant of R2 and C1 needs to be selected to give a reasonable averaging time, depending on the input frequency.&nbsp; Unless very low frequencies need to be measured, the values shown will usually work well.&nbsp; The time constant is 1 second, so an accurate voltage cannot be obtained for around 5 seconds.</p>

<p>The output from Figure 4 can be used to drive a moving coil meter (even though the meter movement would have performed the averaging by itself), or can be digitised for display on an LCD or LED screen.&nbsp; Most cheap digital multimeters use this type of circuit to obtain the reading for AC signals, and the meter is calibrated for RMS.&nbsp; All that's needed is to provide a small amount of gain, so the meter reads 707mV when the DC output from the averaging filter is 637mV (or any multiple or sub-multiple of these voltages).</p>

<p class="t-pic">The 'RMS' reading is only accurate when the input is a sinewave.&nbsp; The error can be significant, as described in the next section.</p>

<p>However, the vast majority of multimeters (analogue and digital) use the average reading, RMS calibrated method.&nbsp; To avoid the inevitable errors with non-sinusoidal waveforms you have to use a 'true RMS' meter.&nbsp; If you only measure sinewaves (or reasonable facsimiles thereof), the errors are not significant and an average reading meter will be perfectly alright for your needs.</p>


<hr><b>RMS Reading</b>
<p>Early 'true RMS' meters were extraordinarily expensive, and they used a variety of means to get the RMS value of the input waveform.&nbsp; One popular method used a thermocouple, measuring the temperature of a sensing element, which was in turn driven by a suitable amplifier.&nbsp; The RMS value of a waveform is defined as that AC voltage (of any waveshape) that provides exactly the same power (heating effect) as an equal DC voltage.&nbsp; So, it you were to measure the temperature rise of a resistor fed with 10V DC and 10V RMS AC, it would be the same for both.&nbsp; It wouldn't matter if the AC was a sinewave, squarewave, or a complex waveform such as an audio signal - provided the signal was steady while the measurement was taken.</p>

<p>Up until the advent of the first ICs that could perform the conversion, very few workshops had access to a true RMS voltmeter because of the cost, and even the early IC based versions were far more expensive than the 'average-reading, RMS calibrated' versions.&nbsp; These are still the most common, and all meters should be assumed to use average reading unless they are <i>specifically</i> stated to be true RMS.</p>

<p>Before we go any further though, it's important to understand exactly what 'RMS' means.&nbsp; It's an abbreviation of 'root mean squared', where we take voltage samples, square them, obtain the mean (average) value of the squares (the sum of values divided by the number of samples), and finally take the square root of the mean, giving us the RMS value.&nbsp; Let's look at a cycle of a sinewave to see how this works&nbsp;...</p>

<p class="t-pic"><img src="./AN012 - Peak, RMS and averaging circuits_files/an012-f5.gif" alt="Figure 5" border="1"><br>Figure 5 - Sinewave, Measured At 30° Intervals</p>

<p>The sinewave can be measured at as many points as you like, with four points being the minimum (0, 90, 180, 270 degrees), but 30° intervals were used for this example as it makes the process easier to understand.&nbsp; With other wave shapes you need enough data points to get an accurate representation of the instantaneous voltages at each point of the waveform.&nbsp; From these measured voltages (which can easily be calculated for a sinewave, triangle or rectangular ('square') waveform) you can then calculate the true RMS voltage for the sinewave.</p>

<p>Mathematically, the voltage is simply the sine of the phase angle multiplied by the peak voltage.&nbsp; Sin(30) is 0.5, sin(60) is 0.866 etc.&nbsp; Note that 360° is not included in the calculation, because that marks the <i>start</i> of the next AC cycle, and <i>not</i> the end of the current cycle.&nbsp; In the table below, a peak voltage of 1V is used (0.707V RMS).</p>

<p>It is usually impossible to calculate the voltages at relevant points of a complex waveform, so it could be printed on graph paper and measured, or digitally sampled and calculations made based on the value of each sample.&nbsp; This is the technique used for fully digital measurement systems.&nbsp; I doubt that many people will want to use graph paper these days, but it certainly works if you have the patience.</p>

<center>
	<table border="1">
	<colgroup span="4" width="160px">
	</colgroup><tbody><tr class="tbldark"><td><b>Measurement #</b></td><td><b>Degrees</b></td><td><b>Voltage</b></td><td><b>Square</b>
	</td></tr><tr><td>1</td><td>0</td><td>0</td><td>0
	</td></tr><tr><td>2</td><td>30</td><td>0.5</td><td>0.25
	</td></tr><tr><td>3</td><td>60</td><td>0.866</td><td>0.75
	</td></tr><tr><td>4</td><td>90</td><td>1</td><td>1
	</td></tr><tr><td>5</td><td>120</td><td>0.866</td><td>0.75
	</td></tr><tr><td>6</td><td>150</td><td>0.5</td><td>0.25
	</td></tr><tr><td>7</td><td>180</td><td>0</td><td>0
	</td></tr><tr><td>8</td><td>210</td><td>0.5</td><td>0.25
	</td></tr><tr><td>9</td><td>240</td><td>0.866</td><td>0.75
	</td></tr><tr><td>10</td><td>270</td><td>1</td><td>1		
	</td></tr><tr><td>11</td><td>300</td><td>0.866</td><td>0.75
	</td></tr><tr><td>12</td><td>330</td><td>0.5</td><td>0.25
	</td></tr><tr><td></td><td colspan="2"><b>Sum</b></td><td><b>6.0</b>
	</td></tr><tr><td></td><td colspan="2">Average, aka <b>Mean</b> ( sum / 12 )</td><td><b>0.50</b>
	</td></tr><tr><td></td><td colspan="2"><b>Square Root of Mean</b></td><td><b>0.707</b>
	</td></tr></tbody></table>
	<b class="t_11b">Table 1 - Derivation Of Root Mean Square</b>
</center>

<p>Now that you know the exact way an RMS value is calculated, it's obvious that an IC version has to perform similar functions.&nbsp; The next question might be "why?".&nbsp; People have used average reading meters that are calibrated to show 'RMS' for years, so why bother with true RMS converters.&nbsp; It's all about accuracy, and errors introduced by the averaging process.&nbsp; The following table list the error with different waveforms - as you can see, they can be extreme in some cases.</p> 

<center>
	<table border="1">
	<tbody><tr class="tbldark"><td valign="top" width="260"><b>Waveform - 1 V Peak</b></td><td valign="top" width="92"><b>Crest Factor<br>V<sub>PEAK</sub> / V<sub>RMS</sub></b>
	</td><td valign="top" width="92"><b>True RMS</b></td><td valign="top" width="92"><b>Avg/ RMS meter¹</b></td><td valign="top" width="92"><b>Error (%)</b> 	
	</td></tr><tr><td>Undistorted Sine Wave</td><td>1.414</td><td>0.707</td><td>0.707</td><td>0
	</td></tr><tr><td>Symmetrical Square Wave</td><td>1.00</td><td>1.00</td><td>1.11</td><td>+11.0
	</td></tr><tr><td>Undistorted Triangle Wave</td><td>1.73</td><td>0.577</td><td>0.555</td><td>-3.8
	</td></tr><tr><td>Gaussian Noise - 98% of Peaks &lt;1V</td><td>3</td><td>0.333</td><td>0.295</td><td>-11.4
	</td></tr><tr><td>Rectangular</td><td>2</td><td>0.5</td><td>0.278</td><td>-44
	</td></tr><tr><td>Pulse Train</td><td>10</td><td>0.1</td><td>0.011</td><td>-89
	</td></tr><tr><td>SCR Waveform - 50% Duty Cycle</td><td>2</td><td>0.495</td><td>0.354</td><td>-28
	</td></tr><tr><td>SCR Waveform - 25% Duty Cycle</td><td>4.7</td><td>0.212</td><td>0.150</td><td>-30
	</td></tr></tbody></table>
	<b class="t_11b">Table 2 - Average Reading Error With Different Waveforms</b>
</center>

<ol>
	<li class="t_11">Reading of an Average Responding Circuit Calibrated to an RMS Sine Wave Value (V)
</li></ol>
 
<p>When measuring AC voltages and currents, we tend to assume that they are RMS, and make power calculations accordingly.&nbsp; Average power (commonly - and incorrectly - referred to as 'RMS power') is simply the product of RMS voltage and RMS current, but if the waveform is not sinusoidal, the error can mean that the answer we get may be way off the mark.&nbsp; Measuring the signal level of music or speech is no different - a high crest factor (V<small>peak</small> / V<small>RMS</small>) will always give an answer that is well below reality.&nbsp; It is the crest factor of waveforms other than sinewaves that causes the problems, and very high crest factors will even cause problems with many RMS converter ICs.&nbsp; Crest factors up to 5 are usually ok with common RMS converter ICs, but higher than that can cause an internal overload and the measurement may still have a significant error.</p>

<p>The AD737 is pretty much a complete system on a chip.&nbsp; The only thing you need to add is a resistor and a few capacitors, and the data sheet has many examples and other info to help you to create a working RMS to DC converter.&nbsp; C2 (the averaging capacitor, C<small>avg</small>) and C3 (the output filtering cap) should be low leakage types.</p>

<p class="t-pic"><img src="./AN012 - Peak, RMS and averaging circuits_files/an012-f6.gif" alt="Figure 6" border="1"><br>Figure 6 - True RMS To DC Converter</p>

<p>The drawing above is simplified, and shows only the basics.&nbsp; Note that the output is inverted, so a 1V peak 707mV RMS) input will give an output of -707mV.&nbsp; The output is also a high impedance and should not be loaded by the external circuit, so ideally the output would be connected to an output buffer as shown in <a href="https://sound-au.com/project140.htm" target="_blank">Project 140</a>.&nbsp; The project circuit also includes provision for a gain trim and DC offset adjustment, both of which will be necessary if you need to measure low voltages (less than 10mV RMS).&nbsp; Although Figure 6 shows an input of 1V peak, the AD737 input should ideally be limited to around 200mV RMS, or internal overload is likely with some waveforms.</p>

<p>The values of C2 and C3 are a compromise, and C2 (C<small>avg</small>) in particular determines the settling time.&nbsp; With a low input voltage of (say) 1mV), the circuit will take roughly 30 seconds to stabilise, falling to about 150ms with a 200mV input.&nbsp; If a smaller value is used for C<small>avg</small>, the settling time is reduced, but the low frequency error increases with higher crest factors.&nbsp; The values shown (100µF for each) were determined after much experimentation with the IC, and give good results overall.</p>


<hr><b>Conclusion</b>
<p>The three main measurement techniques are shown here, and which one is best for the task depends on your application.&nbsp; For accurate power measurements, true RMS is almost always the preferred measurement, but if you only work with sinewaves then an average reading meter (RMS calibrated) will be fine.&nbsp; For measuring complex waveforms such as speech, music, total harmonic distortion (THD) and the like, you really need true RMS (although most distortion meters are average responding, unfortunately).</p>

<p>For audio processing (compressors, limiters, etc.), peak detection is the most common, although some compressors include an average responding circuit as well.&nbsp; Sometimes it may be claimed that it's 'RMS', but that is rarely the case in practice.&nbsp; It's also unlikely that there will be any audible difference, so the extra cost of an RMS converter is usually not warranted.&nbsp; This is especially true since compression and limiting are so often used to make everything the same level, so it sounds flat and lifeless.&nbsp;<img src="./AN012 - Peak, RMS and averaging circuits_files/sad.gif" alt=""></p>

<p>Peak reading meters are not uncommon in recording and broadcast studios, and many people will know about the so-called PPM (Peak Programme Meter) that is used to indicate the absolute peak reading of the speech/ music signal.&nbsp; This is particularly important with digital recordings, because they have a 'hard' limit - commonly referred to as 0dBfs (full scale) - the absolute maximum input level to an analogue to digital converter (ADC) before it clips.&nbsp; Unlike analogue tape (for example), there is no 'soft clip' behaviour, so the PPM is used to indicate the waveform peaks.&nbsp; The PPM is also common in broadcast studios, because the maximum modulation depth (AM) or deviation (FM) allowed must never be exceeded.&nbsp; A full discussion of PP Metering is outside the scope of this article, but there is plenty of info on the Net for those who want to know more.</p>

<p>Fully digital systems such as audio test sets and other measurement systems (oscilloscopes in particular), the peak, average and RMS values are generally calculated, based on making a calculation on each sample, and providing an accurate result with even very difficult waveforms.&nbsp; My digital oscilloscope can be relied upon to give an accurate RMS value with very high crest factors (greater than 20 in some cases), where a true RMS meter using analogue processing (perhaps an AD737) will give the wrong answer because crest factors above 5 can cause internal overload.</p>

<p>The purpose of this application note is to demonstrate the various different measurement types, so you can choose the one that is most likely to satisfy your needs.&nbsp; While true RMS for everything may initially seem like a good idea, it's not always the best choice.&nbsp; Cost is one potential issue, but settling time (especially for low-level signals) may mean that the only sensible choice is to use averaging.&nbsp; Then there are the times when you must know the peak value, and a peak detector is the only thing that will display the voltage peaks.</p>


<hr><b>References</b><br>
<ol>
	<li>AD737 - Analog Devices, True RMS to DC Converter datasheet<br>
	</li><li><a href="https://sound-au.com/project140.htm" target="_blank">Project 140</a> - True RMS Converter Using The AD737
</li></ol>

<hr>
<center>&nbsp;
	<script async="" src="./AN012 - Peak, RMS and averaging circuits_files/f.txt"></script>
	<!-- 728x90 -->
	<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-1947877433449191" data-ad-slot="9701674198" data-adsbygoogle-status="done"><iframe id="aswift_1" style="height: 1px !important; max-height: 1px !important; max-width: 1px !important; width: 1px !important;" src="./AN012 - Peak, RMS and averaging circuits_files/saved_resource(2).html"><iframe id="google_ads_frame1" src="./AN012 - Peak, RMS and averaging circuits_files/saved_resource(3).html"></iframe></iframe></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
</center>

<hr><span class="imgswap"><a href="https://sound-au.com/index.html" style="display:block;"><img src="./AN012 - Peak, RMS and averaging circuits_files/a1.gif" alt="Home"><b class="bb">Main Index</b></a></span>
<span class="imgswap"><a href="https://sound-au.com/appnotes/index.html" style="display:block;"><img src="./AN012 - Peak, RMS and averaging circuits_files/a1.gif" alt="app notes"><b class="bb">App. Notes Index</b></a></span><br>

<table border="1" class="tblblk">
<tbody><tr><td class="t-wht"><a id="copyright"></a><b>Copyright Notice.</b>This article, including but not limited to all text and diagrams, is the intellectual property of Rod Elliott, and is © 2016.&nbsp; Reproduction or re-publication by any means whatsoever, whether electronic, mechanical or electro-mechanical, is strictly prohibited under International Copyright laws.&nbsp; The author (Rod Elliott) grants the reader the right to use this information for personal use only, and further allows that one (1) copy may be made for reference.&nbsp; Commercial use is prohibited without express written authorisation from Rod Elliott.</td></tr>
</tbody></table>
<div class="t-sml">Change Log:&nbsp; Page Created and Copyright © Rod Elliott, July 2016</div><br>

<script type="text/javascript" src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cd8c929c555da1d"></script>


</body><auto-scroll><template shadowrootmode="closed"><div style="transform: translateZ(0px); display: none; position: fixed; left: 0px; top: 0px; width: 100%; height: 100%; z-index: 2147483647; background-repeat: no-repeat;"></div></template></auto-scroll></html>